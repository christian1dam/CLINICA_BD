CREATE DATABASE CLINICA_DB;

GO

USE CLINICA_DB;
g
SET ANSI_NULLS ON;

GO

--LA HE TERMINADO BORRANDO
--CREATE TABLE USUARIOS(
--	CODIGO SMALLINT IDENTITY(1,1) NOT NULL,
--	NOMBRE VARCHAR(50) NOT NULL,
--	CONTRASENYA VARCHAR(50) NOT NULL,
--	CONSTRAINT PK_USUARIOS PRIMARY KEY(CODIGO)
--);

CREATE TABLE PACIENTES(
	CODIGO SMALLINT IDENTITY(1,1) NOT NULL,
	NOMBRE VARCHAR(50) NOT NULL,
	DIRECCION NVARCHAR(100) NOT NULL,
	CIUDAD VARCHAR(50) NOT NULL,
	TELEFONO NVARCHAR(12) NOT NULL,
	DIABETICO BIT NULL,
	FECHA_NACIMIENTO DATETIME NOT NULL,
	TURNO SMALLINT NOT NULL,
	--NULL PORQUE HE BORRADO LA TABLA USUARIOS
	ID_USUARIO SMALLINT NULL,
	CONSTRAINT PK_PACIENTES PRIMARY KEY(CODIGO),
--	CONSTRAINT FK_USUARIOS_PACIENTES FOREIGN KEY(ID_USUARIO) REFERENCES USUARIOS(CODIGO)
);

CREATE TABLE VISITAS(
	CODIGO TINYINT IDENTITY(1,1) NOT NULL,
	ID_PACIENTE SMALLINT NOT NULL,
	FECHA_VISITA DATETIME NOT NULL,
	ENFERMEDAD VARCHAR(50) NOT NULL,
	IMPORTE DECIMAL(6,2) NOT NULL,
	PORCENTAJE_PAGO DECIMAL(3,0) NOT NULL,
	PROXIMA_VISITA DATETIME NOT NULL,
	CONSTRAINT PK_VISITAS PRIMARY KEY(CODIGO),
	CONSTRAINT FK_PACIENTES_VISITAS FOREIGN KEY(ID_PACIENTE) REFERENCES PACIENTES(CODIGO)
);

DROP TABLE VISITAS;

SELECT * FROM VISITAS;

INSERT INTO USUARIOS (NOMBRE, CONTRASENYA)
VALUES
('Juan Pérez', '1234'),
('Luis Fernández', '1234'),
('Ana Martínez', '1234'),
('Carlos Gómez', '1234'),
('Laura López', '1234'),
('Miguel Sánchez', '1234'),
('Carmen Ramírez', '1234'),
('Javier Torres', '1234'),
('Elena Ruiz', '1234'),
('Alberto Vázquez', '1234'),
('Isabel Morales', '1234'),
('Pedro Gómez', '1234'),
('Rosa Medina', '1234'),
('Raúl Ortiz', '1234'),
('Teresa Delgado', '1234'),
('Andrés Vega', '1234'),
('Marta Castro', '1234'),
('Francisco Soto', '1234'),
('Lucía Reyes', '1234');

SET DATEFORMAT 'YMD';

INSERT INTO PACIENTES (NOMBRE, DIRECCION, CIUDAD, TELEFONO, DIABETICO, FECHA_NACIMIENTO, TURNO, ID_USUARIO)
VALUES
('Juan Pérez', 'Calle Mayor 10', 'Madrid', '600123456', 0, '1980-05-15 00:00:00', 1, 1),
('Luis Fernández', 'Calle de la Luna 5', 'Valencia', '600789012', 0, '1985-08-30 00:00:00', 3, 2),
('Ana Martínez', 'Calle del Sol 8', 'Sevilla', '600890123', 1, '1975-12-10 00:00:00', 1, 3),
('Carlos Gómez', 'Calle de la Estrella 3', 'Zaragoza', '600901234', 0, '2000-03-20 00:00:00', 2, 4),
('Laura López', 'Avenida del Prado 12', 'Málaga', '600012345', 1, '1995-06-15 00:00:00', 3, 5),
('Miguel Sánchez', 'Calle del Río 7', 'Murcia', '600234567', 0, '1982-01-10 00:00:00', 1, 6),
('Carmen Ramírez', 'Calle de la Sierra 9', 'Palma', '600345678', 1, '1998-09-25 00:00:00', 2, 7),
('Javier Torres', 'Calle del Mar 6', 'Las Palmas', '600456789', 0, '1987-11-05 00:00:00', 3, 8),
('Elena Ruiz', 'Calle del Viento 4', 'Bilbao', '600567890', 1, '1979-04-30 00:00:00', 1, 9),
('Alberto Vázquez', 'Avenida de la Libertad 15', 'Alicante', '600678901', 0, '1992-07-20 00:00:00', 2, 10),
('Isabel Morales', 'Calle de la Paz 11', 'Córdoba', '600789012', 1, '1983-02-15 00:00:00', 3, 11),
('Pedro Gómez', 'Calle del Amor 14', 'Valladolid', '600890123', 0, '1991-05-10 00:00:00', 1, 12),
('Rosa Medina', 'Calle del Parque 19', 'Vigo', '600901234', 1, '1986-10-20 00:00:00', 2, 13),
('Raúl Ortiz', 'Calle de la Esperanza 13', 'Gijón', '600012345', 0, '2001-12-25 00:00:00', 3, 14),
('Teresa Delgado', 'Calle de la Alegría 18', 'Santander', '600234567', 1, '1984-03-15 00:00:00', 1, 15),
('Andrés Vega', 'Calle del Carmen 16', 'Pamplona', '600345678', 0, '1993-06-20 00:00:00', 2, 16),
('Marta Castro', 'Calle de la Libertad 2', 'Burgos', '600456789', 1, '1996-09-30 00:00:00', 3, 17),
('Francisco Soto', 'Calle de la Paz 17', 'Logroño', '600567890', 0, '1988-11-25 00:00:00', 1, 18),
('Lucía Reyes', 'Calle de la Luz 20', 'Salamanca', '600678901', 1, '1978-01-05 00:00:00', 2, 19);

INSERT INTO visitas (ID_PACIENTE, FECHA_VISITA, ENFERMEDAD, IMPORTE, PORCENTAJE_PAGO, PROXIMA_VISITA) VALUES
(2, '2023-08-02 10:28:25', 'Diabetes', 28.35, 51, '2023-10-08 10:28:25'),
(2, '2023-09-19 10:28:25', 'Bronquitis', 84.24, 35, '2023-12-05 10:28:25'),
(2, '2024-02-24 10:28:25', 'Gripe', 62.78, 10, '2024-03-08 10:28:25'),
(2, '2023-10-18 10:28:25', 'Gastroenteritis', 26.28, 31, '2023-12-19 10:28:25'),
(2, '2023-08-13 10:28:25', 'Diabetes', 12.31, 44, '2023-11-05 10:28:25'),
(3, '2023-07-08 10:28:25', 'Gastroenteritis', 69.07, 50, '2023-09-22 10:28:25'),
(3, '2023-12-20 10:28:25', 'Alergia', 35.65, 25, '2024-02-14 10:28:25'),
(3, '2024-03-25 10:28:25', 'Alergia', 7.59, 81, '2024-03-31 10:28:25'),
(3, '2023-07-24 10:28:25', 'Gripe', 33.81, 40, '2023-09-26 10:28:25'),
(3, '2023-06-07 10:28:25', 'Bronquitis', 26.35, 64, '2023-08-01 10:28:25'),
(3, '2023-12-26 10:28:25', 'Diabetes', 48.08, 30, '2024-01-05 10:28:25'),
(3, '2024-04-25 10:28:25', 'Gripe', 8.20, 13, '2024-06-05 10:28:25'),
(3, '2024-01-03 10:28:25', 'Infección Urinaria', 19.18, 27, '2024-02-20 10:28:25'),
(3, '2023-08-22 10:28:25', 'Infección Urinaria', 0.95, 30, '2023-11-17 10:28:25'),
(4, '2023-12-19 10:28:25', 'Control General', 88.44, 16, '2024-02-23 10:28:25'),
(4, '2024-04-01 10:28:25', 'Artritis', 97.52, 67, '2024-04-21 10:28:25'),
(4, '2023-12-13 10:28:25', 'Gastroenteritis', 53.22, 80, '2023-12-30 10:28:25'),
(4, '2023-12-25 10:28:25', 'Gripe', 7.32, 36, '2024-02-21 10:28:25'),
(4, '2023-10-27 10:28:25', 'Faringitis', 63.17, 57, '2024-01-05 10:28:25'),
(5, '2024-04-12 10:28:25', 'Control Cardiovascular', 92.96, 69, '2024-06-10 10:28:25'),
(5, '2023-09-16 10:28:25', 'Gastroenteritis', 15.85, 89, '2023-10-16 10:28:25'),
(5, '2023-06-01 10:28:25', 'Faringitis', 95.22, 41, '2023-06-19 10:28:25'),
(5, '2024-03-05 10:28:25', 'Control General', 97.81, 42, '2024-05-18 10:28:25'),
(5, '2024-03-30 10:28:25', 'Control Cardiovascular', 37.32, 98, '2024-05-12 10:28:25'),
(5, '2023-08-15 10:28:25', 'Diabetes', 81.77, 13, '2023-11-06 10:28:25'),
(5, '2024-03-15 10:28:25', 'Bronquitis', 38.18, 28, '2024-05-03 10:28:25'),
(5, '2024-02-16 10:28:25', 'Infección Urinaria', 52.29, 84, '2024-03-29 10:28:25'),
(5, '2023-10-01 10:28:25', 'Control General', 43.34, 67, '2023-12-01 10:28:25'),
(5, '2024-04-27 10:28:25', 'Control General', 21.25, 74, '2024-05-26 10:28:25'),
(6, '2024-04-19 10:28:25', 'Gripe', 49.90, 32, '2024-05-12 10:28:25'),
(7, '2023-11-30 10:28:25', 'Bronquitis', 83.33, 42, '2023-12-12 10:28:25'),
(8, '2023-08-29 10:28:25', 'Faringitis', 22.20, 60, '2023-11-15 10:28:25'),
(8, '2024-01-15 10:28:25', 'Gastroenteritis', 53.44, 65, '2024-04-09 10:28:25'),
(8, '2023-10-01 10:28:25', 'Control General', 21.49, 87, '2023-10-24 10:28:25'),
(8, '2023-09-15 10:28:25', 'Faringitis', 13.60, 29, '2023-11-29 10:28:25'),
(8, '2024-05-09 10:28:25', 'Control General', 35.51, 40, '2024-06-06 10:28:25'),
(8, '2023-06-19 10:28:25', 'Control General', 77.79, 63, '2023-07-28 10:28:25'),
(9, '2024-03-10 10:28:25', 'Faringitis', 4.89, 83, '2024-04-28 10:28:25'),
(9, '2023-05-25 10:28:25', 'Control General', 87.92, 98, '2023-07-08 10:28:25'),
(9, '2024-02-09 10:28:25', 'Control General', 89.83, 12, '2024-03-21 10:28:25'),
(9, '2023-06-22 10:28:25', 'Control General', 31.37, 36, '2023-07-12 10:28:25'),
(9, '2023-07-11 10:28:25', 'Gastroenteritis', 42.12, 21, '2023-08-02 10:28:25'),
(9, '2023-08-09 10:28:25', 'Faringitis', 1.83, 52, '2023-09-06 10:28:25'),
(9, '2023-11-05 10:28:25', 'Bronquitis', 61.79, 41, '2023-11-20 10:28:25'),
(9, '2024-03-19 10:28:25', 'Artritis', 95.70, 42, '2024-05-17 10:28:25'),
(9, '2024-03-07 10:28:25', 'Diabetes', 37.52, 82, '2024-05-17 10:28:25'),
(10, '2024-01-03 10:28:25', 'Control Cardiovascular', 57.30, 9, '2024-01-04 10:28:25'),
(10, '2023-08-22 10:28:25', 'Faringitis', 17.47, 51, '2023-10-03 10:28:25'),
(10, '2024-05-06 10:28:25', 'Diabetes', 45.74, 37, '2024-07-06 10:28:25'),
(10, '2023-11-25 10:28:25', 'Bronquitis', 22.55, 37, '2023-12-26 10:28:25'),
(10, '2024-03-23 10:28:25', 'Faringitis', 40.03, 66, '2024-05-26 10:28:25'),
(10, '2024-04-13 10:28:25', 'Control General', 58.73, 59, '2024-06-01 10:28:25'),
(10, '2024-03-23 10:28:25', 'Alergia', 7.51, 80, '2024-03-29 10:28:25'),
(10, '2023-08-08 10:28:25', 'Diabetes', 1.86, 11, '2023-09-25 10:28:25'),
(10, '2023-11-22 10:28:25', 'Diabetes', 23.63, 13, '2023-12-07 10:28:25'),
(10, '2023-06-09 10:28:25', 'Gripe', 98.20, 84, '2023-07-12 10:28:25'),
(11, '2023-08-16 10:28:25', 'Gripe', 97.90, 78, '2023-08-22 10:28:25'),
(11, '2023-05-30 10:28:25', 'Alergia', 66.99, 73, '2023-07-19 10:28:25'),
(11, '2023-09-29 10:28:25', 'Bronquitis', 24.53, 40, '2023-10-02 10:28:25'),
(12, '2024-04-01 10:28:25', 'Gripe', 64.06, 0, '2024-06-20 10:28:25'),
(12, '2024-04-20 10:28:25', 'Control Cardiovascular', 41.81, 24, '2024-05-29 10:28:25'),
(12, '2023-06-12 10:28:25', 'Bronquitis', 7.74, 72, '2023-06-13 10:28:25'),
(13, '2023-10-04 10:28:25', 'Infección Urinaria', 57.25, 15, '2023-10-12 10:28:25'),
(13, '2024-05-12 10:28:25', 'Control General', 92.90, 43, '2024-07-13 10:28:25'),
(13, '2024-01-11 10:28:25', 'Infección Urinaria', 14.02, 7, '2024-02-27 10:28:25'),
(13, '2023-06-21 10:28:25', 'Bronquitis', 11.67, 78, '2023-07-27 10:28:25'),
(14, '2023-12-19 10:28:25', 'Gripe', 87.14, 20, '2024-01-29 10:28:25'),
(14, '2024-01-11 10:28:25', 'Gripe', 60.58, 85, '2024-01-31 10:28:25'),
(14, '2023-12-13 10:28:25', 'Control Cardiovascular', 76.11, 97, '2024-02-09 10:28:25'),
(14, '2023-10-26 10:28:25', 'Gripe', 47.20, 15, '2024-01-20 10:28:25'),
(14, '2024-01-20 10:28:25', 'Faringitis', 24.65, 65, '2024-02-10 10:28:25'),
(14, '2023-11-21 10:28:25', 'Diabetes', 88.70, 49, '2024-01-10 10:28:25'),
(15, '2023-12-24 10:28:25', 'Control General', 7.45, 100, '2024-02-28 10:28:25'),
(15, '2023-08-19 10:28:25', 'Artritis', 45.41, 94, '2023-10-31 10:28:25'),
(15, '2024-01-26 10:28:25', 'Gripe', 69.34, 42, '2024-04-06 10:28:25'),
(15, '2024-05-19 10:28:25', 'Control Cardiovascular', 37.04, 100, '2024-07-29 10:28:25'),
(15, '2023-07-10 10:28:25', 'Faringitis', 87.41, 80, '2023-08-11 10:28:25'),
(15, '2024-01-09 10:28:25', 'Faringitis', 23.42, 83, '2024-02-17 10:28:25'),
(15, '2023-12-05 10:28:25', 'Artritis', 10.14, 37, '2024-02-16 10:28:25'),
(15, '2023-11-09 10:28:25', 'Bronquitis', 66.82, 50, '2023-12-31 10:28:25'),
(16, '2023-06-04 10:28:25', 'Control Cardiovascular', 52.13, 83, '2023-07-06 10:28:25'),
(16, '2023-10-15 10:28:25', 'Alergia', 46.98, 92, '2023-12-01 10:28:25'),
(16, '2024-03-10 10:28:25', 'Gastroenteritis', 28.47, 62, '2024-03-31 10:28:25'),
(16, '2024-02-26 10:28:25', 'Control Cardiovascular', 72.76, 81, '2024-03-26 10:28:25'),
(16, '2023-07-20 10:28:25', 'Control General', 99.31, 53, '2023-09-30 10:28:25'),
(17, '2023-09-19 10:28:25', 'Gripe', 20.58, 74, '2023-10-27 10:28:25'),
(17, '2024-04-19 10:28:25', 'Control Cardiovascular', 79.92, 29, '2024-05-10 10:28:25'),
(17, '2024-04-29 10:28:25', 'Gripe', 76.23, 76, '2024-06-07 10:28:25'),
(17, '2023-11-19 10:28:25', 'Artritis', 18.52, 54, '2023-12-12 10:28:25'),
(17, '2024-03-31 10:28:25', 'Gripe', 97.78, 73, '2024-04-08 10:28:25'),
(17, '2023-09-07 10:28:25', 'Gastroenteritis', 23.31, 18, '2023-10-09 10:28:25'),
(17, '2024-03-05 10:28:25', 'Control Cardiovascular', 26.80, 44, '2024-04-20 10:28:25'),
(18, '2023-09-23 10:28:25', 'Gastroenteritis', 94.09, 70, '2023-10-04 10:28:25'),
(18, '2023-09-15 10:28:25', 'Infección Urinaria', 90.09, 77, '2023-10-14 10:28:25'),
(18, '2024-03-21 10:28:25', 'Faringitis', 10.95, 13, '2024-05-07 10:28:25'),
(18, '2024-02-02 10:28:25', 'Artritis', 53.74, 31, '2024-02-14 10:28:25'),
(19, '2023-08-12 10:28:25', 'Gripe', 88.25, 35, '2023-08-18 10:28:25'),
(19, '2024-04-08 10:28:25', 'Diabetes', 18.19, 82, '2024-05-27 10:28:25'),
(19, '2023-11-05 10:28:25', 'Artritis', 84.61, 3, '2023-11-29 10:28:25'),
(19, '2023-10-13 10:28:25', 'Control Cardiovascular', 86.58, 49, '2024-01-06 10:28:25'),
(19, '2023-07-13 10:28:25', 'Infección Urinaria', 37.77, 16, '2023-09-25 10:28:25'),
(19, '2023-09-13 10:28:25', 'Artritis', 75.85, 61, '2023-12-08 10:28:25'),
(19, '2023-08-15 10:28:25', 'Alergia', 97.31, 44, '2023-08-17 10:28:25'),
(19, '2024-02-13 10:28:25', 'Control General', 96.43, 56, '2024-02-17 10:28:25'),
(19, '2023-07-02 10:28:25', 'Bronquitis', 86.51, 60, '2023-09-10 10:28:25'),
(19, '2024-01-01 10:28:25', 'Gastroenteritis', 72.60, 70, '2024-01-15 10:28:25'),
(20, '2023-11-15 10:28:25', 'Infección Urinaria', 90.43, 86, '2024-01-09 10:28:25'),
(20, '2023-10-23 10:28:25', 'Control Cardiovascular', 61.46, 30, '2023-11-22 10:28:25'),
(20, '2023-09-20 10:28:25', 'Bronquitis', 82.31, 41, '2023-10-30 10:28:25'),
(20, '2023-10-21 10:28:25', 'Artritis', 71.94, 29, '2023-12-23 10:28:25');

ALTER TABLE USUARIOS ADD COLUMN TIPO BIT NOT NULL;